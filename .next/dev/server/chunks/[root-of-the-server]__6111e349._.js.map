{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/scraper/upworkScraper.js"],"sourcesContent":["import puppeteer from 'puppeteer';\nimport { randomUUID } from 'crypto';\n\nlet browser = null;\n\nasync function getBrowser() {\n  if (!browser) {\n    console.log('[Scraper] Launching Puppeteer browser...');\n    browser = await puppeteer.launch({\n      headless: true,\n      args: [\n        '--no-sandbox',\n        '--disable-setuid-sandbox',\n        '--disable-dev-shm-usage',\n        '--disable-accelerated-2d-canvas',\n        '--disable-gpu',\n        '--window-size=1920x1080',\n        '--disable-web-security',\n        '--disable-features=IsolateOrigins,site-per-process',\n      ],\n    });\n    console.log('[Scraper] Browser launched successfully');\n  }\n  return browser;\n}\n\nexport async function closeBrowser() {\n  if (browser) {\n    await browser.close();\n    browser = null;\n  }\n}\n\nfunction extractJobIdFromUrl(url) {\n  if (!url) return null;\n  const match = url.match(/~([a-zA-Z0-9]+)/);\n  return match ? match[1] : null;\n}\n\nfunction buildCanonicalJobUrl(jobId) {\n  return `https://www.upwork.com/jobs/~${jobId}`;\n}\n\nexport async function scrapeUpworkJobs(options) {\n  const { url, limit, sortBy } = options;\n  const jobs = [];\n  let page = null;\n\n  try {\n    const browserInstance = await getBrowser();\n    page = await browserInstance.newPage();\n\n    await page.setUserAgent(\n      'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'\n    );\n\n    await page.setViewport({ width: 1920, height: 1080 });\n\n    await page.setExtraHTTPHeaders({\n      'Accept-Language': 'en-US,en;q=0.9',\n      Accept: 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8',\n    });\n\n    console.log(`[Scraper] Navigating to: ${url}`);\n\n    let navigationSuccess = false;\n    let retries = 3;\n\n    while (retries > 0 && !navigationSuccess) {\n      try {\n        await page.goto(url, {\n          waitUntil: 'domcontentloaded',\n          timeout: 45000,\n        });\n        navigationSuccess = true;\n      } catch (navError) {\n        retries--;\n        console.log(`[Scraper] Navigation attempt failed, ${retries} retries left`);\n        if (retries === 0) throw navError;\n        await new Promise((resolve) => setTimeout(resolve, 2000));\n      }\n    }\n\n    console.log('[Scraper] Waiting for job listings to load...');\n\n    const possibleSelectors = [\n      '[data-test=\"JobTile\"]',\n      '.job-tile',\n      'article[data-ev-label]',\n      'section.air3-card-section',\n      '[data-test=\"job-tile-list\"]',\n      '.up-card-section',\n    ];\n\n    let foundSelector = null;\n    for (const selector of possibleSelectors) {\n      try {\n        await page.waitForSelector(selector, { timeout: 10000 });\n        foundSelector = selector;\n        console.log(`[Scraper] Found jobs using selector: ${selector}`);\n        break;\n      } catch {\n        // Try next selector\n      }\n    }\n\n    if (!foundSelector) {\n      console.log('[Scraper] No standard job selectors found, attempting generic extraction...');\n    }\n\n    await new Promise((resolve) => setTimeout(resolve, 3000));\n\n    if (limit > 10) {\n      console.log('[Scraper] Scrolling to load more jobs...');\n      await autoScroll(page, Math.min(limit / 10, 5));\n    }\n\n    console.log('[Scraper] Extracting job data...');\n    const extractedJobs = await page.evaluate(() => {\n      const jobElements = document.querySelectorAll(\n        '[data-test=\"JobTile\"], .job-tile, article[data-ev-label=\"search_results_impression\"], section.air3-card-section, .up-card-section'\n      );\n\n      console.log(`Found ${jobElements.length} job elements`);\n\n      const jobs = [];\n\n      jobElements.forEach((element) => {\n        try {\n          const titleElement =\n            element.querySelector('[data-test=\"job-title-link\"]') ||\n            element.querySelector('[data-test=\"JobTile-link\"]') ||\n            element.querySelector('h2 a, h3 a') ||\n            element.querySelector('.job-title a') ||\n            element.querySelector('a[href*=\"/jobs/\"]');\n\n          const title = titleElement?.textContent?.trim() || '';\n          const jobUrl = titleElement?.getAttribute('href') || '';\n\n          if (!title) return;\n\n          const descriptionElement =\n            element.querySelector('[data-test=\"JobDescription\"]') ||\n            element.querySelector('[data-test=\"job-description-text\"]') ||\n            element.querySelector('.job-description') ||\n            element.querySelector('.air3-truncation') ||\n            element.querySelector('[data-test=\"UpCLineClamp\"]') ||\n            element.querySelector('p');\n\n          const description = descriptionElement?.textContent?.trim() || '';\n\n          const budgetElement =\n            element.querySelector('[data-test=\"budget\"]') ||\n            element.querySelector('[data-test=\"is-fixed-price\"]') ||\n            element.querySelector('.job-budget') ||\n            element.querySelector('[data-test=\"JobBudget\"]') ||\n            element.querySelector('[data-qa=\"job-budget\"]');\n\n          const budget = budgetElement?.textContent?.trim() || '';\n\n          const hourlyRateElement =\n            element.querySelector('[data-test=\"hourly-rate\"]') ||\n            element.querySelector('[data-qa=\"hourly-rate\"]') ||\n            element.querySelector('.job-hourly-rate');\n\n          const hourlyRate = hourlyRateElement?.textContent?.trim() || '';\n\n          const postedElement =\n            element.querySelector('[data-test=\"posted-on\"]') ||\n            element.querySelector('[data-test=\"job-pubdate\"]') ||\n            element.querySelector('.job-posted-date') ||\n            element.querySelector('time') ||\n            element.querySelector('[data-qa=\"job-posted-on\"]') ||\n            element.querySelector('small');\n\n          const postedDate = postedElement?.textContent?.trim() || 'Recently';\n\n          const skillElements = element.querySelectorAll(\n            '[data-test=\"Skill\"], [data-test=\"token\"] span, .air3-token, .skill-badge, .up-skill-badge'\n          );\n          const skills = [];\n          skillElements.forEach((skill) => {\n            const text = skill.textContent?.trim();\n            if (text && text.length < 50 && text.length > 1) {\n              skills.push(text);\n            }\n          });\n\n          const clientElement =\n            element.querySelector('[data-test=\"client-company-name\"]') ||\n            element.querySelector('.client-name') ||\n            element.querySelector('[data-qa=\"client-company-name\"]');\n          const clientName = clientElement?.textContent?.trim() || '';\n\n          const locationElement =\n            element.querySelector('[data-test=\"client-location\"]') ||\n            element.querySelector('[data-qa=\"client-location\"]') ||\n            element.querySelector('.client-location');\n          const clientCountry = locationElement?.textContent?.trim() || '';\n\n          const verifiedElement = element.querySelector(\n            '[data-test=\"payment-verified\"], .payment-verified, [data-qa=\"payment-verified\"]'\n          );\n          const clientVerified = !!verifiedElement;\n\n          const expElement =\n            element.querySelector('[data-test=\"experience-level\"]') ||\n            element.querySelector('[data-qa=\"experience-level\"]') ||\n            element.querySelector('.experience-level');\n          const experienceLevel = expElement?.textContent?.trim() || '';\n\n          const typeElement =\n            element.querySelector('[data-test=\"job-type\"]') ||\n            element.querySelector('[data-qa=\"job-type\"]');\n          const jobType = typeElement?.textContent?.trim() || '';\n\n          const durationElement =\n            element.querySelector('[data-test=\"duration\"]') ||\n            element.querySelector('[data-qa=\"duration\"]');\n          const duration = durationElement?.textContent?.trim() || '';\n\n          jobs.push({\n            title,\n            description,\n            budget,\n            hourlyRate,\n            clientName,\n            clientCountry,\n            clientVerified,\n            postedDate,\n            skills,\n            jobType,\n            experienceLevel,\n            duration,\n            rawUrl: jobUrl,\n          });\n        } catch (err) {\n          // Skip problematic elements\n        }\n      });\n\n      return jobs;\n    });\n\n    console.log(`[Scraper] Extracted ${extractedJobs.length} jobs from page`);\n\n    const limitedJobs = limit === 0 ? extractedJobs : extractedJobs.slice(0, limit);\n\n    for (const job of limitedJobs) {\n      const jobId = extractJobIdFromUrl(job.rawUrl);\n      const canonicalUrl = jobId\n        ? buildCanonicalJobUrl(jobId)\n        : job.rawUrl.startsWith('http')\n        ? job.rawUrl\n        : job.rawUrl\n        ? `https://www.upwork.com${job.rawUrl}`\n        : '';\n\n      jobs.push({\n        id: randomUUID(),\n        title: job.title,\n        description: job.description,\n        budget: job.budget || undefined,\n        hourlyRate: job.hourlyRate || undefined,\n        clientName: job.clientName || undefined,\n        clientCountry: job.clientCountry || undefined,\n        clientVerified: job.clientVerified,\n        postedDate: job.postedDate,\n        skills: job.skills,\n        jobType: job.jobType || undefined,\n        experienceLevel: job.experienceLevel || undefined,\n        duration: job.duration || undefined,\n        url: canonicalUrl,\n      });\n    }\n\n    if (sortBy === 'budget') {\n      jobs.sort((a, b) => {\n        const budgetA = parseFloat((a.budget || '0').replace(/[^0-9.]/g, '')) || 0;\n        const budgetB = parseFloat((b.budget || '0').replace(/[^0-9.]/g, '')) || 0;\n        return budgetB - budgetA;\n      });\n    }\n\n    console.log(`[Scraper] Successfully processed ${jobs.length} jobs`);\n    return jobs;\n  } catch (error) {\n    console.error('[Scraper] Error scraping jobs:', error);\n    throw error;\n  } finally {\n    if (page) {\n      await page.close().catch(() => {});\n    }\n  }\n}\n\nasync function autoScroll(page, maxScrolls = 5) {\n  await page.evaluate(async (maxScrolls) => {\n    await new Promise((resolve) => {\n      let totalHeight = 0;\n      let scrollCount = 0;\n      const distance = 500;\n      const timer = setInterval(() => {\n        const scrollHeight = document.body.scrollHeight;\n        window.scrollBy(0, distance);\n        totalHeight += distance;\n        scrollCount++;\n\n        if (totalHeight >= scrollHeight - window.innerHeight || scrollCount >= maxScrolls) {\n          clearInterval(timer);\n          resolve();\n        }\n      }, 500);\n    });\n  }, maxScrolls);\n}\n\nexport function generateMockJobs(count) {\n  const mockTitles = [\n    'React Developer Needed for E-commerce Platform',\n    'Full Stack Developer for SaaS Application',\n    'Node.js Backend Engineer',\n    'Senior Frontend Developer - Vue.js',\n    'Mobile App Developer (React Native)',\n    'Python Developer for Data Analysis',\n    'WordPress Developer for Blog Migration',\n    'JavaScript Expert for Browser Extension',\n    'UI/UX Designer with Figma Experience',\n    'TypeScript Developer for API Development',\n  ];\n\n  const mockSkills = [\n    ['React', 'TypeScript', 'Node.js', 'Redux'],\n    ['Vue.js', 'JavaScript', 'CSS', 'Vuex'],\n    ['Python', 'Django', 'PostgreSQL', 'REST API'],\n    ['React Native', 'iOS', 'Android', 'Mobile Development'],\n    ['Node.js', 'Express', 'MongoDB', 'GraphQL'],\n    ['WordPress', 'PHP', 'MySQL', 'WooCommerce'],\n    ['JavaScript', 'HTML', 'CSS', 'Chrome Extension'],\n    ['Python', 'Pandas', 'NumPy', 'Data Analysis'],\n    ['Figma', 'UI Design', 'UX Research', 'Prototyping'],\n    ['TypeScript', 'REST API', 'GraphQL', 'Node.js'],\n  ];\n\n  const mockDescriptions = [\n    'We are looking for an experienced developer to build a scalable e-commerce platform. The ideal candidate should have expertise in modern web technologies and a strong portfolio.',\n    'Join our team to develop a cutting-edge SaaS application. We need someone who can work independently and deliver high-quality code.',\n    \"We're building an innovative product and need a talented developer to help bring our vision to life. Remote work is welcome.\",\n    'Looking for a skilled professional to help with our web application development. Must have excellent communication skills.',\n    'Seeking a developer to join our growing startup. This is a long-term opportunity with potential for advancement.',\n  ];\n\n  const jobs = [];\n\n  for (let i = 0; i < count; i++) {\n    const titleIndex = i % mockTitles.length;\n    const descIndex = i % mockDescriptions.length;\n    const mockJobId = randomUUID().replace(/-/g, '').slice(0, 18);\n\n    jobs.push({\n      id: randomUUID(),\n      title: mockTitles[titleIndex],\n      description: mockDescriptions[descIndex],\n      budget: Math.random() > 0.5 ? `$${Math.floor(Math.random() * 5000) + 500}` : undefined,\n      hourlyRate: Math.random() > 0.5 ? `$${Math.floor(Math.random() * 100) + 20}` : undefined,\n      clientName: `Client ${i + 1}`,\n      clientCountry: ['United States', 'United Kingdom', 'Canada', 'Australia', 'Germany'][\n        Math.floor(Math.random() * 5)\n      ],\n      clientVerified: Math.random() > 0.3,\n      postedDate: ['Just now', '1 hour ago', '3 hours ago', 'Yesterday', '2 days ago'][\n        Math.floor(Math.random() * 5)\n      ],\n      skills: mockSkills[titleIndex],\n      jobType: Math.random() > 0.5 ? 'Fixed Price' : 'Hourly',\n      experienceLevel: ['Entry Level', 'Intermediate', 'Expert'][Math.floor(Math.random() * 3)],\n      duration: ['Less than 1 month', '1 to 3 months', '3 to 6 months', 'More than 6 months'][\n        Math.floor(Math.random() * 4)\n      ],\n      url: `https://www.upwork.com/jobs/~${mockJobId}`,\n    });\n  }\n\n  return jobs;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 429, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/storage.js"],"sourcesContent":["let jobs = [];\n\nexport function getJobs() {\n  return jobs;\n}\n\nexport function getJobById(id) {\n  return jobs.find(job => job.id === id);\n}\n\nexport function setJobs(newJobs) {\n  jobs = newJobs;\n}\n\nexport function addJobs(newJobs) {\n  jobs = [...jobs, ...newJobs];\n}\n\nexport function clearJobs() {\n  jobs = [];\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA,IAAI,OAAO,EAAE;AAEN,SAAS;IACd,OAAO;AACT;AAEO,SAAS,WAAW,EAAE;IAC3B,OAAO,KAAK,IAAI,CAAC,CAAA,MAAO,IAAI,EAAE,KAAK;AACrC;AAEO,SAAS,QAAQ,OAAO;IAC7B,OAAO;AACT;AAEO,SAAS,QAAQ,OAAO;IAC7B,OAAO;WAAI;WAAS;KAAQ;AAC9B;AAEO,SAAS;IACd,OAAO,EAAE;AACX"}},
    {"offset": {"line": 464, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/schema.js"],"sourcesContent":["import { z } from 'zod';\n\nexport const jobSchema = z.object({\n  id: z.string(),\n  title: z.string(),\n  description: z.string(),\n  budget: z.string().optional(),\n  hourlyRate: z.string().optional(),\n  clientName: z.string().optional(),\n  clientCountry: z.string().optional(),\n  clientVerified: z.boolean().default(false),\n  postedDate: z.string(),\n  skills: z.array(z.string()).default([]),\n  jobType: z.string().optional(),\n  experienceLevel: z.string().optional(),\n  duration: z.string().optional(),\n  url: z.string(),\n});\n\nexport const scrapeRequestSchema = z.object({\n  url: z.string().url('Please enter a valid Upwork URL'),\n  limit: z.number().min(5, 'Minimum scrape limit is 5').default(10),\n  sortBy: z.enum(['date', 'budget', 'relevance']).default('date'),\n});\n\nexport const scrapeResponseSchema = z.object({\n  jobs: z.array(jobSchema),\n  totalFound: z.number(),\n  scrapedCount: z.number(),\n  status: z.enum(['success', 'error', 'partial']),\n  message: z.string().optional(),\n});\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,MAAM,YAAY,2IAAC,CAAC,MAAM,CAAC;IAChC,IAAI,2IAAC,CAAC,MAAM;IACZ,OAAO,2IAAC,CAAC,MAAM;IACf,aAAa,2IAAC,CAAC,MAAM;IACrB,QAAQ,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,YAAY,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC/B,YAAY,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC/B,eAAe,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAClC,gBAAgB,2IAAC,CAAC,OAAO,GAAG,OAAO,CAAC;IACpC,YAAY,2IAAC,CAAC,MAAM;IACpB,QAAQ,2IAAC,CAAC,KAAK,CAAC,2IAAC,CAAC,MAAM,IAAI,OAAO,CAAC,EAAE;IACtC,SAAS,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,iBAAiB,2IAAC,CAAC,MAAM,GAAG,QAAQ;IACpC,UAAU,2IAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,KAAK,2IAAC,CAAC,MAAM;AACf;AAEO,MAAM,sBAAsB,2IAAC,CAAC,MAAM,CAAC;IAC1C,KAAK,2IAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IACpB,OAAO,2IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,6BAA6B,OAAO,CAAC;IAC9D,QAAQ,2IAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;QAAU;KAAY,EAAE,OAAO,CAAC;AAC1D;AAEO,MAAM,uBAAuB,2IAAC,CAAC,MAAM,CAAC;IAC3C,MAAM,2IAAC,CAAC,KAAK,CAAC;IACd,YAAY,2IAAC,CAAC,MAAM;IACpB,cAAc,2IAAC,CAAC,MAAM;IACtB,QAAQ,2IAAC,CAAC,IAAI,CAAC;QAAC;QAAW;QAAS;KAAU;IAC9C,SAAS,2IAAC,CAAC,MAAM,GAAG,QAAQ;AAC9B"}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/scrape/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { scrapeUpworkJobs, generateMockJobs } from '../../../lib/scraper/upworkScraper.js';\nimport { setJobs, getJobs } from '../../../lib/storage.js';\nimport { scrapeRequestSchema } from '../../../lib/schema.js';\n\nexport async function POST(request) {\n  try {\n    const body = await request.json();\n    const validatedData = scrapeRequestSchema.parse(body);\n    const { url, limit, sortBy } = validatedData;\n\n    console.log(`[API] Scrape request: ${url}, limit: ${limit}, sortBy: ${sortBy}`);\n\n    let jobs = [];\n    let status = 'success';\n    let message = undefined;\n\n    try {\n      jobs = await scrapeUpworkJobs({ url, limit, sortBy });\n\n      if (jobs.length === 0) {\n        console.log('[API] No jobs found, returning mock data');\n        jobs = generateMockJobs(limit);\n        status = 'partial';\n        message = 'No jobs found on the page. Showing sample data for demonstration. This could be due to Upwork blocking automated access or the search returning no results.';\n      }\n    } catch (scrapeError) {\n      console.error('[API] Scrape error:', scrapeError.message);\n      jobs = generateMockJobs(limit);\n      status = 'partial';\n      message = `Scraping failed: ${scrapeError.message}. Showing sample data for demonstration.`;\n    }\n\n    setJobs(jobs);\n\n    return NextResponse.json({\n      jobs,\n      totalFound: jobs.length,\n      scrapedCount: jobs.length,\n      status,\n      message,\n    });\n  } catch (error) {\n    console.error('[API] Error:', error);\n    return NextResponse.json(\n      { error: error.message || 'Failed to scrape jobs' },\n      { status: 400 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;;;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,gBAAgB,sIAAmB,CAAC,KAAK,CAAC;QAChD,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG;QAE/B,QAAQ,GAAG,CAAC,CAAC,sBAAsB,EAAE,IAAI,SAAS,EAAE,MAAM,UAAU,EAAE,QAAQ;QAE9E,IAAI,OAAO,EAAE;QACb,IAAI,SAAS;QACb,IAAI,UAAU;QAEd,IAAI;YACF,OAAO,MAAM,IAAA,qJAAgB,EAAC;gBAAE;gBAAK;gBAAO;YAAO;YAEnD,IAAI,KAAK,MAAM,KAAK,GAAG;gBACrB,QAAQ,GAAG,CAAC;gBACZ,OAAO,IAAA,qJAAgB,EAAC;gBACxB,SAAS;gBACT,UAAU;YACZ;QACF,EAAE,OAAO,aAAa;YACpB,QAAQ,KAAK,CAAC,uBAAuB,YAAY,OAAO;YACxD,OAAO,IAAA,qJAAgB,EAAC;YACxB,SAAS;YACT,UAAU,CAAC,iBAAiB,EAAE,YAAY,OAAO,CAAC,wCAAwC,CAAC;QAC7F;QAEA,IAAA,2HAAO,EAAC;QAER,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB;YACA,YAAY,KAAK,MAAM;YACvB,cAAc,KAAK,MAAM;YACzB;YACA;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAwB,GAClD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}